{% extends "master.html" %}

{% block title %}User {{username}}{% endblock %}
{% set tag = "users" %}
{% from "_browseheader.html" import browse_header %}


{% block header %}
    <link rel="stylesheet" type="text/css" media="screen"
        href="{{ url_for('static', filename='toggle.css') }}"/>
{% endblock %}


{% from "_render_repo.html" import render_repos_as_card %}


{% block content %}
<div class="repo-header p-t-1">
  <div class="container">
    {{browse_header(select=tag)}}
  </div>
</div>
<div class="p-t-2">
  <div class="container">
    <h2>
        {{ username | avatar(36) | safe }} {{ username }}

    </h2>
    <p title="{{ user.created.strftime('%Y-%m-%d') }}">
      Joined {{ user.created | humanize }}
    </p>

    {{ render_repos_as_card(repos, repos_length, 'Projects') }}
    {{ render_repos_as_card(forks, forks_length,'Forks',) }}
    <section class="project_list" id="group_list">
        <header>
            <h2>Groups ({{ user.groups | length }})</h2>
        </header>
        {% for group in user.groups %}
          <div class="col-lg-4 col-md-6">
            <div class="project_wrapper m-b-1">
                <div class="projecticon pull-xs-left"><span class="oi" data-glyph="people"></span></div>
                <a class="project_link logo_link" href="{{ url_for('view_group', group=group.group_name)}}">
                    <div class="repo_name"><strong>{{ group }}</strong></div>
               </a>
            </div>
          </div>
        {% else %}
        <p>No group found</p>
        {% endfor %}
    </section>

    {% if config.get('DATAGREPPER_URL') %}
    <section class="project_list" id="user_graph">
        <header>
            <h2>Contributions</h2>
        </header>
        <a href="{{config.get('DATAGREPPER_URL')}}/raw?category={{config.get('DATAGREPPER_CATEGORY', 'pagure')}}&user={{username}}" target="_blank">
          <img src="{{config.get('DATAGREPPER_URL')}}/charts/line?category={{config.get('DATAGREPPER_CATEGORY', 'pagure')}}&user={{username}}&split_on=users&delta=31536000&N=12&title=&width=600&height=200&style=light&fill=True" alt="User activity graph"/>
        </a>
    </section>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block jscripts %}
    {{ super() }}
    <script type="text/javascript">
      $(function(){
        $('.show_parts input[type="checkbox"]').change(function(){
          $('#' + $(this).attr('name')).toggle();
        });
      });
    </script>
{% endblock %}
